<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>LiveReload with Awestruct</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <style>
      body {
        padding-top: 60px;
        padding-bottom: 60px;
      }
    </style>
    <link href="/stylesheets/styles.css" rel="stylesheet" type="text/css">
    <link href="/stylesheets/prettify.css" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->
    <script src=" https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js" type="text/javascript"></script>
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="col-md-4">
          <a class="navbar-brand" href="/">Aslak Knutsen</a>
        </div>
        <div class="col-md-4 nav">
          &lt;
          <a id="past">Past</a>
        </div>
        <div class="col-md-4 nav" style="text-align:right">
          <a id="future">Future</a>
          &gt;
        </div>
      </div>
    </nav>
    <div class="container">
      <div id="blog_entry">
        <div class="row headline">
          <div class="col-sm-10">
            <h1>LiveReload with Awestruct</h1>
          </div>
        </div>
        <p>Yesterday I came across a &quot;Getting Started with SASS&quot; video at <a href="css-tricks.com/video-screencasts/111-get-yourself-preprocessing-in-just-a-few-minutes/">CSS-Tricks</a> where the presenter was using <a href="http://incident57.com/codekit/">CodeKit</a>. Now, CodeKit is a sass/less/jade/++ file listener / compiler for Mac, but one interesting feature I noticed was the auto refresh and css/javascript injection of compiled sources into a running browser. No more manual window swapping and refresh. Just code away and see the changes as they happen in the browser. Very cool. I want...</p>
        
        <p>That of course spawned a little Google Search session. The end result was simpler then anticipated. </p>
        
        <h2>The Result</h2>
        
        <p>Check this little YouTube video: <a href="http://www.youtube.com/watch?v=4LWbLa6lgxI">LiveReload+Awestruct</a></p>
        
        <h2>How To</h2>
        
        <p>There is a plugin to <a href="https://github.com/guard/guard-livereload">Guard</a> called LiveReload. What this does is simply to act as a <a href="http://livereload.com/">LiveReload</a> backend and push messages to the <a href="https://chrome.google.com/webstore/detail/jnihajbhpnppcggbcgedagnkighmdlei">LiveReload Chrome Extension</a> when a file change. Pretty simple. </p>
        
        <p>To set it up all you need to do is:</p>
        
        <pre><code>gem install guard-livereload&#x000A;gem install yajl-ruby&#x000A;</code></pre>
        
        <p>Go to your favorite Awestruct based website and add this your <em>Guardfile</em>:</p>
        
        <pre><code>guard &#39;livereload&#39; do&#x000A;   watch(%r{_site/.+\.(css|js|html|json)})&#x000A;end&#x000A;</code></pre>
        
        <p>Now you have Guard configured to listen for changes in Awestruct&#39;s output folder, _site/. Awestruct it self is already listening to the source folders to trigger compile, so no extra is needed here.</p>
        
        <p>Next step is to install the <a href="https://chrome.google.com/webstore/detail/jnihajbhpnppcggbcgedagnkighmdlei">LiveReload Chrome Extension</a>. This gives you a little LR icon in your tool bar. We&#39;ll get back to that.</p>
        
        <p>To start up the whole thing we do the following:</p>
        
        <pre><code>guard start&#x000A;</code></pre>
        
        <p>The output should be similar to:</p>
        
        <pre><code>Guard uses NotifySend to send notifications.&#x000A;Guard is now watching at &#39;/home/aslak/dev/source/testing/arquillian.github.com&#39;&#x000A;LiveReload 1.6 is waiting for a browser to connect.&#x000A;&gt; &#x000A;</code></pre>
        
        <p>In a new console you start up Awestruct:</p>
        
        <pre><code>awestruct -d&#x000A;</code></pre>
        
        <p>Go to the normal Awestruct localhost url, http://localhost:4242/. Connect the Browser client to the file system watcher by pressing the shiny new LR button. The guard process should tell you that the client has connected:</p>
        
        <pre><code>&gt; Browser connected.&#x000A;Browser URL: http://localhost:4242/&#x000A;</code></pre>
        
        <p>That&#39;s it! Change any of the source files in your site and see the browser refresh/reload the resources. </p>
      </div>
    </div>
    <nav class="navbar navbar-default navbar-fixed-bottom">
      <div class="container-fluid">
        <div class="col-md-3" style="padding-top:5px">
          <a href="http://arquillian.org">
            <img src="/images/arquillian_icon_32px-glossy.png">
          </a>
        </div>
      </div>
    </nav>
    <script src="/javascripts/prettify.js" type="text/javascript"></script>
    <script type="text/javascript">
      $(window).load(function() { $('pre>code').addClass('prettify').parent().addClass('prettify'); prettify() })
    </script>
    <script>
      $(window).load(function() {
        $.ajax({
          url: '/api/blogs.json',
          dataType: 'json'
        }).done(function(data) {
      
          blogs = {
            data: data,
            container: "#blog_entry",
            future_link: "#future",
            past_link: "#past"
          }
          blogs.initialize = function(current_url) {
            this.data.current(current_url)
      
            if(this.data.hasPast()) {
              past = this.data.getPast()
              this.prepareNav(this.past_link, past.name, past.path)
            }
            else {
              this.prepareNav(this.past_link, "Index", "/index.html")
            }
            if(this.data.hasFuture()) {
              future = this.data.getFuture()
              this.prepareNav(this.future_link, future.name, future.path)
            }
            else {
              this.prepareNav(this.future_link, "Index", "/index.html")
            }
          }
          blogs.data.current = function(url) {
            this.current_url = url
          }
          blogs.data.hasPast = function() {
            var index = this.current_index()
            return index+1 <= (this.length-1)
          }
          blogs.data.getPast = function() {
            return this[this.current_index()+1]
          }
          blogs.data.hasFuture = function() {
            var index = this.current_index()
            return index-1 >= 0
          }
          blogs.data.getFuture = function() {
            return this[this.current_index()-1]
          }
          blogs.data.current_index = function() {
            for(i = 0; i < this.length; i++) {
              if(this[i].path == this.current_url) {
                return i;
              }
            }
            return -1
          }
          blogs.prepareNav = function(link, text, url) {
            $(link)
              .html(text)
              .fadeIn(500)
              .on().click(function() {
                blogs.load(url)
              })
          }
          blogs.load = function (url) {
            cont = this.container
            $(cont).slideUp('fast', function() {
              $(this).load(url + ' ' + cont, function() {
                $('pre>code').addClass('prettify')
                  .parent().addClass('prettify');
                prettify();
                blogs.initialize(url)
                $(this).slideDown('fast');
              })
            })
          }
          blogs.initialize(window.location.pathname)
      
          $(window).keydown(function (e) {
            var keyCode = e.keyCode || e.which,
                  arrow = {left: 37, right: 39};
      
            switch(keyCode) {
              case arrow.left:
                if(blogs.data.hasPast()) {
                  blogs.load(blogs.data.getPast().path)
                }
                else {
                  blogs.load("/index.html")
                }
              break;
              case arrow.right:
                if(blogs.data.hasFuture()) {
                  blogs.load(blogs.data.getFuture().path)
                }
                else {
                  blogs.load("/index.html")
                }
              break;
            }
          })
        })
      })
    </script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount','UA-38014373-1']);
    _gaq.push(['_trackPageview']);
    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>
